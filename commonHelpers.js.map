{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-function.js","../src/main.js"],"sourcesContent":["import axios from \"axios\";\n\nexport async function getSearchPhotoAPI(userSymbol, page = 1)  {\n  const KEY_API = '42320428-e8ed9ab9e474091db19815d3a'\n\n  const listParameters = {\n    key: KEY_API,\n    q: userSymbol,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page,\n    per_page: 40,\n  }\n\n  try {\n    const queryString = new URLSearchParams(listParameters).toString();\n    const BASE_URL = await axios.get(`https://pixabay.com/api/?${queryString}`)\n    return BASE_URL.data\n  } catch (error) {\n    throw new Error('Failed to fetch data');\n  }\n}","import SimpleLightbox from \"simplelightbox\";\nimport \"simplelightbox/dist/simple-lightbox.min.css\";\n\nconst refs = {\n  formEL: document.querySelector('.js-search-form'),\n  listEL: document.querySelector('.gallery'),\n}\n\nlet lightbox = null; // зберігатиме посилання на поточний екземпляр галереї\n\nexport function photoTemplate(data) {\n  const options = {\n    captions: true,\n    captionSelector: 'img',\n    captionType: 'attr',\n    captionsData: 'alt',\n    captionPosition: 'bottom',\n    animation: 250,\n    widthRatio: 0.9,\n    scaleImageToRatio: true,\n  }\n  const markup = data.hits\n    .map(data => {\n      return `<li class=\"gallery-item\"><a href=\"${data.webformatURL}\">\n          <img class=\"gallery-image\" src=\"${data.webformatURL}\" alt=\"${data.tags}\"></a>\n          <div class=\"bloc-content\">\n          <p><b>Likes: </b>${data.likes}</p>\n          <p><b>Views: </b>${data.views}</p>\n          <p><b>Comments: </b>${data.comments}</p>\n          <p><b>Downloads: </b>${data.downloads}</p>\n          </div>\n          </li>`;\n    })\n    .join(\"\")\n  refs.listEL.insertAdjacentHTML('beforeend', markup);\n\n  // Знищення попереднього екземпляру галереї, якщо він існує\n  if (lightbox) {\n    lightbox.destroy();\n  }\n\n  // Ініціалізація нового екземпляру галереї\n  lightbox = new SimpleLightbox('.gallery a' , options);\n  refs.formEL.reset();\n}\n","import iziToast from \"izitoast\";\nimport \"izitoast/dist/css/iziToast.min.css\";\nimport { getSearchPhotoAPI } from './js/pixabay-api.js';\nimport { photoTemplate } from './js/render-function.js';\n\nconst appState = {\n  lastSearchData: null,\n};\n\nconst refs = {\n  formEL: document.querySelector('.js-search-form'),\n  loaderEl: document.querySelector('.loader'),\n  galleryList: document.querySelector('.gallery'),\n  buttonLoad: document.querySelector('.btn-load'),\n  loaderMore: document.querySelector('.loader-more')\n};\n\nrefs.loaderEl.style.display = \"none\";\nrefs.loaderMore.style.display = \"none\";\n\n// Обробник події для форми пошуку\nrefs.formEL.addEventListener('submit', async (e) => {\n  e.preventDefault();\n  const userSubmit = e.target.elements.query.value.trim();\n\n  // Перевірка, чи не складається запит тільки з пробілів\n  if (!userSubmit) {\n    // Показ повідомлення про невалідний запит\n    iziToast.show({\n      message: \"Please enter a valid search query.\",\n      backgroundColor: 'red',\n      position: 'topRight'\n    });\n    return;\n  }\n\n  refs.galleryList.innerHTML = '';\n  refs.loaderEl.style.display = \"block\"; // Відображення loader\n\n  try {\n    const data = await getSearchPhotoAPI(userSubmit);\n    appState.lastSearchData = userSubmit;\n\n    if (!data.hits.length) {\n      refs.buttonLoad.style.display = \"none\";\n      iziToast.show({\n        message: \"Sorry, there are no images matching your search query. Please try again!\",\n        backgroundColor: 'red',\n        position: 'topRight'\n      });\n    } else {\n      photoTemplate(data);\n      if (data.hits.length >= 40) {\n        refs.buttonLoad.style.display = \"block\";\n      }\n    }\n  } catch (error) {\n    iziToast.show({\n      message: \"An error occurred while fetching images. Please try again later.\",\n      backgroundColor: 'red',\n      position: 'topRight'\n    });\n  } finally {\n    refs.loaderEl.style.display = \"none\"; // Приховання loader\n  }\n\n  e.target.reset(); // Очищення форми\n});\n\n// Обробник події для кнопки \"Load More\"\nrefs.buttonLoad.addEventListener('click', async (e) => {\n  if (!appState.lastSearchData) {\n    return;\n  }\n  const currentPage = Math.ceil(refs.galleryList.children.length / 40) + 1; // Заміна магічного числа\n  refs.loaderMore.style.display = \"block\";\n\n  try {\n    const data = await getSearchPhotoAPI(appState.lastSearchData, currentPage);\n    photoTemplate(data);\n\n    if (data.hits.length >= 40) { // Заміна магічного числа\n      const cardHeight = refs.galleryList.firstElementChild.getBoundingClientRect().height;\n      window.scrollBy({ top: cardHeight * 2, behavior: 'smooth' });\n    }\n\n  } catch (error) {\n    refs.buttonLoad.style.display = \"none\";\n    // Показ повідомлення про досягнення кінця результатів\n    iziToast.show({\n      message: \"We're sorry, but you've reached the end of search results.\",\n      backgroundColor: 'blue',\n      position: 'topRight'\n    });\n  } finally {\n    refs.loaderMore.style.display = \"none\";\n  }\n});\n"],"names":["getSearchPhotoAPI","userSymbol","page","listParameters","queryString","axios","refs","lightbox","photoTemplate","data","options","markup","SimpleLightbox","appState","e","userSubmit","iziToast","currentPage","cardHeight"],"mappings":"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"}